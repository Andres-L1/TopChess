{
  "meta": {
    "project": "TopChess",
    "date": "2026-02-14",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "TopChess is an online platform connecting chess teachers and students with a realtime virtual classroom (chessboard sync + AV) and integrated user workflows for authentication, onboarding, wallets and messaging. The MVP focuses on reliable move synchronization, teacher marketplace, and basic wallet/dashboard flows.",
  "core_goals": [
    "Provide a real-time synchronized chess classroom where teacher and student see the same board state and can communicate via audio/video.",
    "Enable quick and secure user authentication and onboarding flows for students and teachers.",
    "Expose teacher discovery (marketplace) and direct messaging to schedule and coordinate lessons.",
    "Offer basic wallet visibility and dashboards for students and teachers in the MVP.",
    "Provide an admin interface for global oversight and user management."
  ],
  "features": [
    {
      "name": "User Authentication",
      "description": "Login using Google Auth or test accounts for development; route users to onboarding or dashboards based on account state.",
      "user_flows": [
        "Navigate to / -> Click \"Login with Google\" button -> Complete Google sign-in popup -> See redirect to /onboarding or /student-dashboard or /dashboard",
        "Navigate to / -> Click \"Soy Alumno (Prueba)\" -> Automatically sign in as test student -> See redirect to /student-dashboard",
        "Navigate to / -> Click \"Soy Profesor (Prueba)\" -> Automatically sign in as test teacher -> See redirect to /dashboard",
        "Navigate to / -> Click \"Login with Google\" button -> Close or fail Google sign-in popup -> See authentication error message"
      ]
    },
    {
      "name": "Onboarding",
      "description": "Collect role selection and create the user profile document in Firestore for new authenticated users.",
      "user_flows": [
        "Navigate to /onboarding -> Select \"Quiero Aprender\" -> Click confirm button -> Firestore creates user document -> See redirect to /student-dashboard",
        "Navigate to /onboarding -> Select \"Quiero Enseñar\" -> Click confirm button -> Firestore creates user document -> See redirect to /dashboard",
        "Navigate to /onboarding -> Select role -> Click confirm button -> Firestore setDoc fails -> See onboarding save error message and retry CTA"
      ]
    },
    {
      "name": "Home / Teacher Marketplace",
      "description": "Landing page that lists teachers with filters, allowing students to browse profiles and start contact or booking flows.",
      "user_flows": [
        "Navigate to / -> See teacher listing cards with photo, rating, specialty and price -> Click a teacher card -> See teacher detail or contact CTA",
        "Navigate to / -> Use filters on teacher listing -> See filtered results update on page",
        "Navigate to / -> Apply filters that return no matches -> See empty state messaging and suggestions to broaden search"
      ]
    },
    {
      "name": "Classroom (Realtime Chessboard & AV)",
      "description": "Virtual classroom with Chessground chessboard synced via Firestore and optional LiveKit audio/video for live lessons.",
      "user_flows": [
        "Navigate to /room/:teacherId -> Allow camera and microphone -> Join LiveKit room -> See chessboard loaded",
        "Navigate to /room/:teacherId -> Drag and drop chess pieces -> See move applied locally -> See opponent's moves in real-time -> See Firestore room document updated",
        "Navigate to /room/:teacherId -> Drag and drop an illegal move (invalid by chess.js) -> See move rejected and original board restored",
        "Navigate to /room/:teacherId -> Attempt to start audio/video without valid LiveKit credentials -> See audio/video connection error and fallback UI message"
      ]
    },
    {
      "name": "Chat (Student <-> Teacher)",
      "description": "Direct messaging between student and teacher for coordination and pre/post class communication.",
      "user_flows": [
        "Navigate to /chat/:teacherId -> Type message in input -> Click Send -> See message appear in chat window",
        "Navigate to /chat/:teacherId -> Click Send -> Network or Firestore write fails -> See 'message failed' indicator and retry option",
        "Navigate to /chat/:teacherId -> Receive message from teacher -> See incoming message appear in chat in real-time"
      ]
    },
    {
      "name": "Wallet Management",
      "description": "View current balance and transaction history; MVP supports viewing and simulated withdrawals.",
      "user_flows": [
        "Navigate to /wallet -> See current balance displayed -> Scroll to transaction history list -> Click a transaction -> See transaction details",
        "Navigate to /wallet -> Transactions list fails to load due to network/Firestore error -> See error message and retry CTA"
      ]
    },
    {
      "name": "Teacher Dashboard",
      "description": "Teacher-specific dashboard showing earnings, number of classes, student list and quick links to start classes.",
      "user_flows": [
        "Navigate to /dashboard -> See earnings total and list of upcoming/past classes -> Click a class -> See class details",
        "Navigate to /dashboard -> Click Start Class -> Navigate to /room/:teacherId to open classroom",
        "Navigate to /dashboard as unauthorized user -> See access denied or redirect to /onboarding"
      ]
    },
    {
      "name": "Student Dashboard",
      "description": "Student dashboard showing upcoming classes, class history and wallet balance.",
      "user_flows": [
        "Navigate to /student-dashboard -> See upcoming classes calendar and history list -> Click a scheduled class -> Click Join -> Navigate to /room/:teacherId",
        "Navigate to /student-dashboard before completing onboarding -> See prompt to complete onboarding at /onboarding"
      ]
    },
    {
      "name": "User Profile",
      "description": "User profile settings for updating display info and preferences.",
      "user_flows": [
        "Navigate to /profile -> Edit profile fields (name, bio, photo) -> Click Save -> See success confirmation and updated profile data",
        "Navigate to /profile -> Click Save -> Firestore update fails -> See error notification and unchanged fields"
      ]
    },
    {
      "name": "Admin Panel",
      "description": "Admin dashboard for managing users and platform metrics (restricted access).",
      "user_flows": [
        "Navigate to /admin -> Authenticate as admin -> See global metrics and user list -> Select user -> Modify role or status -> See success confirmation",
        "Navigate to /admin as non-admin user -> See access denied page or redirect to authorized dashboard"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "frontend",
    "tech_stack": [
      "TypeScript",
      "React",
      "Tailwind CSS",
      "Firebase",
      "Chess.js",
      "Chessground",
      "LiveKit"
    ],
    "routes": [
      {
        "path": "/",
        "file": "src/pages/Home.tsx",
        "auth_required": false,
        "description": "Landing page and teacher listing"
      },
      {
        "path": "/onboarding",
        "file": "src/pages/Onboarding.tsx",
        "auth_required": true,
        "description": "Role selection for new users"
      },
      {
        "path": "/chat/:teacherId",
        "file": "src/pages/Chat.tsx",
        "auth_required": true,
        "description": "Chat room between student and teacher"
      },
      {
        "path": "/room/:teacherId",
        "file": "src/pages/Classroom.tsx",
        "auth_required": true,
        "description": "Virtual classroom with chessboard"
      },
      {
        "path": "/classroom/:teacherId",
        "file": "src/pages/Classroom.tsx",
        "auth_required": true,
        "description": "Virtual classroom (alias)"
      },
      {
        "path": "/dashboard",
        "file": "src/pages/TeacherDashboard.tsx",
        "auth_required": true,
        "description": "Dashboard for teachers"
      },
      {
        "path": "/student-dashboard",
        "file": "src/pages/StudentDashboard.tsx",
        "auth_required": true,
        "description": "Dashboard for students"
      },
      {
        "path": "/wallet",
        "file": "src/pages/Wallet.tsx",
        "auth_required": true,
        "description": "User wallet and balance management"
      },
      {
        "path": "/profile",
        "file": "src/pages/UserProfile.tsx",
        "auth_required": true,
        "description": "User profile settings"
      },
      {
        "path": "/admin",
        "file": "src/pages/AdminDashboard.tsx",
        "auth_required": true,
        "description": "Admin control panel"
      }
    ],
    "features": [
      {
        "name": "User Authentication",
        "description": "Login with Google or use test accounts for dev",
        "files": [
          "src/App.tsx",
          "src/firebase.ts"
        ],
        "entry_route": "/",
        "user_interactions": [
          "Click \"Login with Google\" button",
          "Click \"Soy Alumno (Prueba)\" or \"Soy Profesor (Prueba)\" for quick access"
        ],
        "api_calls": [
          {
            "method": "FIREBASE_AUTH",
            "endpoint": "signInWithPopup"
          }
        ],
        "auth_required": false
      },
      {
        "name": "Onboarding",
        "description": "Select user role and create profile",
        "files": [
          "src/pages/Onboarding.tsx"
        ],
        "entry_route": "/onboarding",
        "user_interactions": [
          "Select \"Quiero Aprender\" or \"Quiero Enseñar\"",
          "Click confirm button"
        ],
        "api_calls": [
          {
            "method": "FIREBASE_FIRESTORE",
            "endpoint": "setDoc(users)"
          }
        ],
        "auth_required": true
      },
      {
        "name": "Classroom Sync",
        "description": "Real-time chessboard synchronization",
        "files": [
          "src/pages/Classroom.tsx",
          "src/components/ChessBoard/Board.tsx"
        ],
        "entry_route": "/room/:teacherId",
        "user_interactions": [
          "Drag and drop chess pieces",
          "See opponent's moves in real-time"
        ],
        "api_calls": [
          {
            "method": "FIREBASE_FIRESTORE",
            "endpoint": "updateDoc(rooms)"
          }
        ],
        "auth_required": true
      },
      {
        "name": "Wallet Management",
        "description": "View balance and transaction history",
        "files": [
          "src/pages/Wallet.tsx"
        ],
        "entry_route": "/wallet",
        "user_interactions": [
          "View current balance",
          "View transaction history list"
        ],
        "auth_required": true
      }
    ],
    "known_limitations": [
      {
        "issue": "LiveKit audio/video requires valid credentials and room tokens",
        "location": "src/pages/Classroom.tsx",
        "impact": "Audio/video might fail if LiveKit server is not configured correctly in .env"
      }
    ]
  }
}
