import{c as K,R as F,j as e,M as se,i as M,r as i,X as V,B as _e,b as le,k as Ee,e as ne,a as Ie,u as Ue,f as d,z as x}from"./index-CzcpBJsu.js";import{l as ae}from"./lichessService-BsrYpUv4.js";import{T as ie}from"./trophy-DQ2nfKCu.js";import{U as L}from"./users-B7MQcEWT.js";import{P as De}from"./plus-XdMrPms-.js";import{C as Re}from"./Calendar-B2TNMGFb.js";import{S as $}from"./Skeleton-CsCAunvD.js";import{D as Me}from"./dollar-sign-1jOhxoBl.js";import{R as q,A as O,a as G}from"./AreaChart-CHdHFNFE.js";import{C as $e}from"./clock-Dw_W_dXF.js";import{V as re,E as Le}from"./video-vDvZY4XY.js";import"./calendar-DbPXPSHB.js";import"./check-x-PtShFY.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=K("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=K("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=K("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);async function qe(){const a=new Uint8Array(32);return window.crypto.getRandomValues(a),oe(a)}async function Oe(a){const p=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",p);return oe(new Uint8Array(c))}function oe(a){return btoa(String.fromCharCode(...a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}const Ge=({club:a,teacherProfile:o,clubTeachers:p,handleCreateClub:c,isCreatingClub:g,inviteEmail:s,setInviteEmail:j,handleInviteTeacher:C,isInviting:w})=>!a&&(o==null?void 0:o.role)!=="club_director"?e.jsx("div",{className:"max-w-2xl mx-auto py-12 text-center animate-enter",children:e.jsxs("div",{className:"bg-gradient-to-br from-gold/20 to-transparent p-8 rounded-3xl border border-gold/20 shadow-2xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gold/5 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/2"}),e.jsx(se,{size:48,className:"text-gold mx-auto mb-6 group-hover:scale-110 transition-transform"}),e.jsx("h2",{className:"text-3xl font-black text-white mb-4 tracking-tight",children:"Escala tu Academia"}),e.jsxs("p",{className:"text-white/60 mb-8 leading-relaxed",children:["Crea tu propio club para gestionar múltiples profesores, ver sus clases en tiempo real en la ",e.jsx("span",{className:"text-gold font-bold",children:"Oficina Virtual"})," y centralizar tus operaciones."]}),e.jsx("button",{onClick:c,disabled:g,className:"btn-primary px-8 py-4",children:g?"Creando...":"Crear mi Club"})]})}):a?e.jsxs("div",{className:"space-y-6 animate-enter",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-[#1b1a17] p-6 rounded-2xl border border-white/5 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gold/10 flex items-center justify-center border border-gold/20",children:e.jsx(ie,{className:"text-gold",size:32})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-white",children:a.name}),e.jsx("p",{className:"text-sm text-gold/60 font-bold uppercase tracking-widest",children:"Director del Club"})]})]}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsxs(M,{to:"/office",className:"flex-1 md:flex-none flex items-center justify-center gap-2 bg-white/5 hover:bg-white/10 text-white px-6 py-3 rounded-xl border border-white/10 transition-all font-bold text-sm",children:[e.jsx(se,{size:18}),"Oficina Virtual"]}),e.jsx("button",{className:"flex-1 md:flex-none flex items-center justify-center gap-2 bg-[#1b1a17] text-white/40 p-3 rounded-xl border border-white/5 hover:text-white transition-all",children:e.jsx(He,{size:20})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"glass-panel p-6 rounded-2xl border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(L,{size:20,className:"text-gold"}),"Profesores del Club"]}),e.jsx("span",{className:"bg-white/5 px-3 py-1 rounded-full text-xs font-mono text-white/40",children:p.length})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:p.map(b=>e.jsxs("div",{className:"p-4 rounded-xl bg-black/40 border border-white/5 hover:border-gold/20 transition-all flex items-center gap-4",children:[e.jsx("img",{src:b.image||`https://ui-avatars.com/api/?name=${encodeURIComponent(b.name)}&background=333&color=fff`,className:"w-10 h-10 rounded-lg object-cover",alt:b.name}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h4",{className:"font-bold text-sm text-white truncate",children:b.name}),e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-widest",children:b.title||"Instructor"})]}),e.jsx("div",{className:`w-2 h-2 rounded-full ${b.onlineStatus==="online"?"bg-green-500 shadow-[0_0_8px_rgba(34,197,94,0.5)]":b.onlineStatus==="in_class"?"bg-red-500 animate-pulse":"bg-gray-500"}`})]},b.id))})]})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"glass-panel p-6 rounded-2xl border border-gold/20 bg-gradient-to-br from-gold/5 to-transparent",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx(De,{size:20,className:"text-gold"}),"Invitar Profesor"]}),e.jsx("p",{className:"text-xs text-text-muted mb-6",children:"Añade nuevos instructores a tu club ingresando su correo electrónico registrado en TopChess."}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsx("input",{type:"email",required:!0,placeholder:"correo@ejemplo.com",value:s,onChange:b=>j(b.target.value),className:"input-premium text-sm"}),e.jsx("button",{type:"submit",disabled:w||!s,className:"btn-primary w-full py-3",children:w?"Invitando...":"Añadir al Club"})]})]})})]})]}):e.jsx("div",{className:"text-center py-20 text-white/40",children:"Cargando datos del club..."}),Ve=F.memo(Ge),Ke=({availability:a,handleSaveAvailability:o})=>e.jsx("div",{className:"glass-panel p-4 md:p-6 rounded-2xl animate-enter overflow-x-auto",children:e.jsx("div",{className:"min-w-[600px] md:min-w-0",children:e.jsx(Re,{mode:"edit",availability:a,onSaveAvailability:o})})}),We=F.memo(Ke),Xe=({isOpen:a,onClose:o,onSave:p,students:c})=>{const[g,s]=i.useState(""),[j,C]=i.useState(""),[w,b]=i.useState(""),[N,I]=i.useState("lichess_study"),[y,_]=i.useState(""),[z,A]=i.useState(!1);if(!a)return null;const U=async n=>{n.preventDefault(),A(!0);try{const m=c.find(l=>l.id===w);await p({studentId:w,studentName:(m==null?void 0:m.name)||"Estudiante",title:g,description:j,type:N,referenceData:y}),o()}catch(m){console.error(m)}finally{A(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-dark-panel border border-white/10 rounded-2xl w-full max-w-lg overflow-hidden shadow-2xl relative",children:[e.jsx("button",{onClick:o,className:"absolute top-4 right-4 text-text-muted hover:text-white transition-colors",children:e.jsx(V,{size:24})}),e.jsxs("div",{className:"p-6 border-b border-white/5",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[e.jsx(_e,{className:"text-gold",size:24}),"Asignar Tarea"]}),e.jsx("p",{className:"text-sm text-text-muted mt-1",children:"Crea un ejercicio para tus alumnos"})]}),e.jsxs("form",{onSubmit:U,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"space-y-2 group",children:[e.jsxs("label",{className:"text-[10px] font-black text-text-muted hover:text-white transition-colors uppercase tracking-widest flex items-center gap-2",children:[e.jsx(L,{size:14})," Alumno"]}),e.jsxs("select",{required:!0,value:w,onChange:n=>b(n.target.value),className:"input-premium appearance-none",children:[e.jsx("option",{value:"",children:"Selecciona un alumno..."}),c.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),e.jsxs("div",{className:"space-y-2 group",children:[e.jsxs("label",{className:"text-[10px] font-black text-text-muted hover:text-white transition-colors uppercase tracking-widest flex items-center gap-2",children:[e.jsx(Fe,{size:14})," Título"]}),e.jsx("input",{type:"text",required:!0,placeholder:"Ej: Finales de Torres",value:g,onChange:n=>s(n.target.value),className:"input-premium"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 group",children:[e.jsx("label",{className:"text-[10px] font-black text-text-muted hover:text-white transition-colors uppercase tracking-widest",children:"Tipo"}),e.jsxs("select",{value:N,onChange:n=>I(n.target.value),className:"input-premium appearance-none text-sm",children:[e.jsx("option",{value:"lichess_study",children:"Estudio Lichess"}),e.jsx("option",{value:"custom_fen",children:"Posición (FEN)"}),e.jsx("option",{value:"puzzle",children:"Puzzle ID"})]})]}),e.jsxs("div",{className:"space-y-2 group",children:[e.jsx("label",{className:"text-[10px] font-black text-text-muted hover:text-white transition-colors uppercase tracking-widest",children:N==="lichess_study"?"URL estudio":N==="custom_fen"?"FEN String":"Puzzle ID"}),e.jsx("input",{type:"text",required:!0,placeholder:N==="lichess_study"?"https://lichess.org/study/...":"...",value:y,onChange:n=>_(n.target.value),className:"input-premium font-mono text-[11px]"})]})]}),e.jsxs("div",{className:"space-y-2 group",children:[e.jsx("label",{className:"text-[10px] font-black text-text-muted hover:text-white transition-colors uppercase tracking-widest",children:"Instrucciones"}),e.jsx("textarea",{rows:3,placeholder:"Explica qué debe hacer el alumno...",value:j,onChange:n=>C(n.target.value),className:"input-premium resize-none text-sm"})]}),e.jsx("button",{type:"submit",disabled:z,className:"btn-primary w-full py-4 mt-4",children:z?"Asignando...":"Asignar Tarea"})]})]})})},Ze=({homeworks:a,myStudents:o,isHomeworkModalOpen:p,setIsHomeworkModalOpen:c,handleCreateHomework:g})=>e.jsxs("div",{className:"space-y-6 animate-enter",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Tareas Asignadas"}),e.jsx("button",{onClick:()=>c(!0),className:"bg-gold hover:bg-white text-black px-4 py-2 rounded-xl text-xs font-black uppercase tracking-widest transition-all shadow-lg shadow-gold/10",children:"+ Nueva Tarea"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.length===0?e.jsx("div",{className:"col-span-full py-12 text-center border-2 border-dashed border-white/5 rounded-2xl",children:e.jsx("p",{className:"text-text-muted",children:"No has asignado tareas aún."})}):a.map(s=>e.jsxs("div",{className:"glass-panel p-5 rounded-2xl border border-white/5 hover:border-gold/20 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 right-0 w-16 h-16 rounded-full blur-2xl -translate-y-1/2 translate-x-1/2 ${s.status==="completed"?"bg-green-500/20":"bg-gold/10"}`}),e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-black uppercase tracking-widest ${s.status==="completed"?"bg-green-500/10 text-green-400":"bg-yellow-500/10 text-yellow-500"}`,children:s.status==="completed"?"Completada":"Pendiente"}),e.jsx("span",{className:"text-[10px] text-text-muted font-mono",children:new Date(s.assignedAt).toLocaleDateString()})]}),e.jsx("h3",{className:"font-bold text-white mb-1 truncate",title:s.title,children:s.title}),e.jsx("p",{className:"text-xs text-text-muted mb-4 line-clamp-2",children:s.description||"Sin descripción"}),e.jsxs("div",{className:"flex items-center gap-2 mt-auto pt-3 border-t border-white/5 text-xs",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-white/10 flex items-center justify-center font-bold text-[10px]",children:(s.studentName||"U").substring(0,1)}),e.jsx("span",{className:"text-white/80 font-bold",children:s.studentName})]})]},s.id))}),e.jsx(Xe,{isOpen:p,onClose:()=>c(!1),onSave:g,students:o})]}),Je=F.memo(Ze),Qe=({isLoading:a,stats:o,levelInfo:p,currency:c,progressPercent:g,teacherProfile:s,requests:j,pendingBookings:C,handleAcceptRequest:w,handleRejectRequest:b,handleAcceptBooking:N,handleRejectBooking:I,nextBooking:y,currentUserId:_,myStudents:z,handleLichessConnect:A,handleLichessDisconnect:U})=>{var m;const{t:n}=le();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:a?e.jsx(e.Fragment,{children:[1,2,3,4].map(l=>e.jsxs("div",{className:"glass-panel p-4 md:p-6 rounded-2xl flex flex-col justify-between",children:[e.jsx($,{width:"40%",height:20}),e.jsx($,{width:"80%",height:40})]},l))}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"glass-panel p-4 md:p-6 rounded-2xl flex flex-col justify-between group hover:border-gold/30 transition-all relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start relative z-10",children:[e.jsx("div",{className:"p-3 rounded-xl bg-green-500/10 text-green-400 group-hover:scale-110 transition-transform",children:e.jsx(Me,{size:24})}),e.jsxs("span",{className:"text-xs font-mono text-green-400/80",children:["Ganancia: ",(p.currentComm*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"mt-4 relative z-10",children:[e.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-white tracking-tight",children:[o.earnings.toFixed(2),c]}),e.jsx("p",{className:"text-xs md:text-sm text-text-muted",children:n("dashboard.total_earnings")})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 opacity-30 pointer-events-none",children:e.jsx(q,{width:"100%",height:"100%",debounce:50,children:e.jsx(O,{data:[{v:0},{v:10},{v:5},{v:20},{v:15},{v:30},{v:o.earnings>30?o.earnings:40}],children:e.jsx(G,{type:"monotone",dataKey:"v",stroke:"#4ade80",fill:"#4ade80",strokeWidth:2})})})})]}),e.jsxs("div",{className:"glass-panel p-4 md:p-6 rounded-2xl flex flex-col justify-between group hover:border-gold/30 transition-all relative overflow-hidden",children:[e.jsx("div",{className:"flex justify-between items-start relative z-10",children:e.jsx("div",{className:"p-3 rounded-xl bg-blue-500/10 text-blue-400 group-hover:scale-110 transition-transform",children:e.jsx(L,{size:24})})}),e.jsxs("div",{className:"mt-4 relative z-10",children:[e.jsx("span",{className:"text-2xl md:text-3xl font-bold text-white tracking-tight",children:o.students}),e.jsx("p",{className:"text-xs md:text-sm text-text-muted",children:n("dashboard.active_students")})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 opacity-30 pointer-events-none",children:e.jsx(q,{width:"100%",height:"100%",debounce:50,children:e.jsx(O,{data:[{v:1},{v:2},{v:2},{v:3},{v:o.students>3?o.students:4}],children:e.jsx(G,{type:"stepAfter",dataKey:"v",stroke:"#3b82f6",fill:"#3b82f6",strokeWidth:2})})})})]}),e.jsxs("div",{className:"glass-panel p-4 md:p-6 rounded-2xl flex flex-col justify-between group hover:border-gold/30 transition-all relative overflow-hidden",children:[e.jsx("div",{className:"flex justify-between items-start relative z-10",children:e.jsx("div",{className:"p-3 rounded-xl bg-purple-500/10 text-purple-400 group-hover:scale-110 transition-transform",children:e.jsx($e,{size:24})})}),e.jsxs("div",{className:"mt-4 relative z-10",children:[e.jsxs("span",{className:"text-2xl md:text-3xl font-bold text-white tracking-tight",children:[o.hours,"h"]}),e.jsx("p",{className:"text-xs md:text-sm text-text-muted",children:n("dashboard.classes_given")})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 opacity-30 pointer-events-none",children:e.jsx(q,{width:"100%",height:"100%",debounce:50,children:e.jsx(O,{data:[{v:0},{v:5},{v:8},{v:15},{v:o.hours}],children:e.jsx(G,{type:"monotone",dataKey:"v",stroke:"#a855f7",fill:"#a855f7",strokeWidth:2})})})})]}),e.jsxs("div",{className:"glass-panel p-4 md:p-6 rounded-2xl bg-gradient-to-br from-dark-panel to-gold/5 border-gold/20 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gold/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ie,{size:20,className:"text-gold"}),e.jsxs("span",{className:"text-gold font-bold text-sm uppercase tracking-wider",children:["Nivel ",p.name]}),(s==null?void 0:s.title)&&e.jsx("span",{className:"ml-auto px-1.5 py-0.5 bg-gold text-black text-[8px] rounded font-black tracking-widest",children:s.title})]}),e.jsx("div",{className:"w-full bg-black/40 h-2 rounded-full mb-2 overflow-hidden relative",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-gold to-orange-500 shadow-[0_0_10px_rgba(255,215,0,0.5)] transition-all duration-1000",style:{width:`${g}%`}})}),e.jsxs("p",{className:"text-xs text-text-muted flex justify-between",children:[e.jsxs("span",{children:[(s==null?void 0:s.classesGiven)||0," / ",p.target," Clases"]}),e.jsxs("span",{className:"text-gold",children:["Siguiente: ",p.next]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-white/5 text-[10px] space-y-1",children:[e.jsxs("p",{className:"flex justify-between text-white/80",children:[e.jsx("span",{children:"Tu Comisión Actual:"})," ",e.jsxs("span",{className:"text-green-400 font-mono font-bold",children:[(p.currentComm*100).toFixed(0),"%"]})]}),e.jsxs("p",{className:"flex justify-between text-white/50",children:[e.jsx("span",{children:"Siguiente Nivel:"})," ",e.jsxs("span",{className:"text-gold font-mono",children:[(p.nextComm*100).toFixed(0),"%"]})]})]})]})]})]})}),e.jsxs("div",{className:"flex gap-6 flex-col lg:flex-row h-full",children:[e.jsxs("div",{className:"flex-1 glass-panel rounded-2xl p-4 md:p-6 min-h-[400px]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-white",children:n("dashboard.pending_requests")}),!a&&j.length>0&&e.jsxs("span",{className:"bg-red-500/20 text-red-400 px-2 py-0.5 rounded text-xs font-bold animate-pulse",children:[j.length," nuevas"]})]}),e.jsx("div",{className:"space-y-4",children:a?e.jsx(e.Fragment,{children:[1,2,3].map(l=>e.jsx("div",{className:"p-3 md:p-4 rounded-xl bg-white/5 border border-white/5 flex items-center justify-between gap-3",children:e.jsx($,{width:"100%",height:60})},l))}):j.length===0&&C.length===0?e.jsxs("div",{className:"text-center py-10 text-white/20 border-2 border-dashed border-white/5 rounded-2xl",children:[e.jsx(Ee,{size:40,className:"mx-auto mb-4 opacity-10"}),e.jsx("p",{className:"text-sm font-medium",children:"Bandeja de entrada vacía"})]}):e.jsxs(e.Fragment,{children:[C.map(l=>e.jsxs("div",{className:"p-4 rounded-2xl bg-gradient-to-r from-blue-500/10 to-transparent border border-blue-500/20 hover:border-gold/30 transition-all flex flex-col sm:flex-row items-start sm:items-center justify-between group gap-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 w-1 bg-blue-500 scale-y-0 group-hover:scale-y-100 transition-transform origin-top"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-500/10 flex items-center justify-center font-bold text-blue-400 border border-blue-500/20 shadow-lg",children:(l.studentName||"U").substring(0,1).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white text-sm",children:l.studentName||"Alumno"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500 animate-pulse"}),e.jsxs("span",{className:"text-[10px] text-blue-400/80 font-black uppercase tracking-widest leading-none",children:["Nueva Clase: ",l.date," @ ",l.time]})]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>N(l.id),className:"flex-1 sm:flex-none px-4 py-2 rounded-xl bg-blue-500 text-white font-black text-[10px] uppercase tracking-widest hover:bg-white hover:text-blue-600 transition-all shadow-lg shadow-blue-500/10",children:"Confirmar"}),e.jsx("button",{onClick:()=>I(l.id),className:"p-2 rounded-xl bg-white/5 text-white/40 hover:bg-red-500/10 hover:text-red-400 transition-all border border-white/10",children:e.jsx(V,{size:18})})]})]},l.id)),j.map(l=>e.jsxs("div",{className:"p-4 rounded-2xl bg-gradient-to-r from-white/[0.03] to-transparent border border-white/5 hover:border-gold/30 transition-all flex flex-col sm:flex-row items-start sm:items-center justify-between group gap-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 w-1 bg-gold scale-y-0 group-hover:scale-y-100 transition-transform origin-top"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gold/10 flex items-center justify-center font-bold text-gold border border-gold/20 shadow-lg",children:(l.studentName||"U").substring(0,1).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white text-sm",children:l.studentName||"Interesado"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-gold animate-pulse"}),e.jsx("span",{className:"text-[10px] text-gold/60 font-black uppercase tracking-widest",children:"Nueva Conexión"})]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>w(l.id),className:"flex-1 sm:flex-none px-4 py-2 rounded-xl bg-gold text-black font-black text-[10px] uppercase tracking-widest hover:bg-white transition-all shadow-lg shadow-gold/10",children:"Aceptar"}),e.jsx("button",{onClick:()=>b(l.id),"aria-label":"Rechazar solicitud",className:"p-2 rounded-xl bg-white/5 text-white/40 hover:bg-red-500/10 hover:text-red-400 transition-all border border-white/10",children:e.jsx(V,{size:18})})]})]},l.id))]})})]}),e.jsxs("div",{className:"w-full lg:w-80 flex flex-col gap-6",children:[e.jsxs("div",{className:"glass-panel rounded-2xl p-4 md:p-6 flex flex-col gap-4",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-white mb-2",children:n("dashboard.quick_access")}),e.jsxs(M,{to:`/classroom/${_}`,className:"group relative overflow-hidden rounded-xl aspect-video bg-black flex items-center justify-center border border-white/10 hover:border-gold/50 transition-all",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-dark-panel to-gold/20 opacity-40 group-hover:scale-105 transition-transform duration-700"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gold/90 text-black flex items-center justify-center shadow-[0_0_20px_rgba(255,215,0,0.3)] group-hover:scale-110 transition-transform",children:e.jsx(re,{size:24})}),e.jsx("span",{className:"font-bold text-white tracking-wide",children:n("dashboard.enter_classroom")})]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-white/5 border border-white/5 space-y-2",children:[e.jsx("h4",{className:"font-bold text-sm text-gold",children:n("dashboard.next_class")}),y?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs text-white",children:["Clase el ",y.date]}),e.jsxs("p",{className:"text-[10px] text-text-muted",children:["Hora: ",y.time]}),e.jsx("div",{className:"h-1 w-full bg-black/50 rounded-full overflow-hidden mt-1",children:e.jsx("div",{className:"h-full bg-green-500 w-full animate-pulse-slow"})})]}):e.jsx("p",{className:"text-xs text-text-muted italic",children:"No tienes clases próximas agendadas."})]})]}),e.jsxs("div",{className:"glass-panel rounded-2xl p-4 md:p-6 flex flex-col gap-4 bg-gradient-to-br from-[#1b1a17] to-white/[0.05]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/10 flex items-center justify-center",children:e.jsx("svg",{viewBox:"0 0 448 512",className:"w-5 h-5 fill-white opacity-80",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M0 432L448 432 448 480 0 480 0 432zM334.8 191.1C355.7 154.5 354 116.3 328.7 87.7 296 50.8 238.2 46.2 199.1 77.5 167.3 103 154.7 146.4 167 182.8 123.6 211.5 96 261.2 96 317.9L96 384l256 0 0-66.2C352 268 332.1 224 334.8 191.1zM224 0C241.7 0 256 14.3 256 32 256 49.7 241.7 64 224 64 206.3 64 192 49.7 192 32 192 14.3 206.3 0 224 0z"})})}),e.jsx("h2",{className:"text-lg font-bold text-white",children:"Lichess Sync"}),(s==null?void 0:s.lichessAccessToken)&&e.jsx("div",{className:"ml-auto w-2 h-2 rounded-full bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.5)]"})]}),e.jsx("p",{className:"text-[10px] text-white/50 leading-relaxed",children:s!=null&&s.lichessAccessToken?`Conectado como ${s.lichessUsername}. Tus estudios privados ahora son visibles en el aula.`:"Conecta tu cuenta para importar estudios privados y públicos directamente en el Aula."}),e.jsx("div",{className:"pt-2",children:s!=null&&s.lichessAccessToken?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-grow bg-white/5 border border-white/10 rounded-xl px-4 py-2 flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-white/10 flex items-center justify-center font-bold text-[10px] text-white",children:(m=s.lichessUsername)==null?void 0:m.substring(0,1).toUpperCase()}),e.jsx("span",{className:"text-xs text-white/90 font-bold",children:s.lichessUsername})]}),e.jsx("button",{onClick:U,className:"p-2 bg-red-500/10 hover:bg-red-500/20 border border-red-500/20 rounded-xl text-red-500 transition-all",title:"Desconectar",children:e.jsx(ne,{size:16})})]}):e.jsx("button",{onClick:A,className:"btn-primary w-full py-3 text-[10px]",children:"Conectar con Lichess"})})]})]}),e.jsxs("div",{className:"flex-1 glass-panel rounded-2xl p-4 md:p-6 min-h-[400px]",children:[e.jsx("h2",{className:"text-lg md:text-xl font-bold text-white mb-6",children:"Mis Alumnos"}),e.jsx("div",{className:"space-y-4",children:a?[1,2].map(l=>e.jsx($,{width:"100%",height:80},l)):z.length===0?e.jsxs("div",{className:"text-center py-10 text-white/20 border-2 border-dashed border-white/5 rounded-2xl",children:[e.jsx(L,{size:40,className:"mx-auto mb-4 opacity-10"}),e.jsx("p",{className:"text-sm font-medium",children:"Sin alumnos activos"})]}):z.map(l=>e.jsxs("div",{className:"p-5 rounded-2xl bg-[#1b1a17] border border-white/5 hover:border-gold/20 transition-all flex flex-col gap-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-gold/20 to-gold/5 flex items-center justify-center font-bold text-gold border border-gold/10",children:(l.name||"U").substring(0,1).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-white text-sm",children:l.name||"Usuario"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-[9px] font-black text-white/30 uppercase tracking-widest bg-white/5 px-2 py-0.5 rounded-full",children:"ESTUDIANTE"}),e.jsx("div",{className:"w-1 h-1 rounded-full bg-green-500"}),e.jsx("span",{className:"text-[9px] text-green-500/60 font-black uppercase tracking-widest",children:"En línea"})]})]})]}),e.jsx("div",{className:"flex flex-col items-end",children:e.jsx("span",{className:"text-[10px] font-mono text-white/40 italic",children:"Última clase: Ayer"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(M,{to:`/chat/${l.id}`,className:"bg-white/5 hover:bg-white/10 text-white/80 py-2.5 rounded-xl transition-all flex items-center justify-center gap-2 group",children:[e.jsx(Be,{size:14,className:"group-hover:text-gold transition-colors"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Mensaje"})]}),e.jsxs(M,{to:`/classroom/${_}`,className:"bg-gold hover:bg-white text-black py-2.5 rounded-xl transition-all flex items-center justify-center gap-2 group font-black shadow-lg shadow-gold/5",children:[e.jsx(re,{size:14}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Aula en vivo"})]})]})]},l.id))})]})]})]})},Ye=F.memo(Qe),mt=()=>{const{currentUserId:a,logout:o}=Ie(),p=Ue(),{t:c}=le(),[g,s]=i.useState("overview"),[j,C]=i.useState({earnings:0,students:0,hours:0}),[w,b]=i.useState([]),[N,I]=i.useState([]),[y,_]=i.useState([]),[z,A]=i.useState([]),[U,n]=i.useState([]),[m,l]=i.useState(null),[de,W]=i.useState(null),[ce,xe]=i.useState(!1),[me,X]=i.useState(!0),[E,ue]=i.useState(null),[he,Z]=i.useState([]),[B,J]=i.useState(""),[pe,Q]=i.useState(!1),[ge,Y]=i.useState(!1);i.useEffect(()=>{if(!a)return;let t=!0,r,f;return(async()=>{X(!0);try{const u=await d.getTeacherById(a);t&&l(u);const D=await d.getTeacherAvailability(a);t&&n(D);const R=await d.getHomeworksForTeacher(a);if(t&&A(R),u&&t&&C({earnings:u.earnings,students:u.classesGiven>0?Math.floor(u.classesGiven/4):0,hours:u.classesGiven}),(u==null?void 0:u.role)==="club_director"){const v=await d.getClubByDirectorId(a);t&&v&&ue(v)}}catch(u){console.error("Error loading dashboard data",u),x.error("Error al cargar datos estáticos")}finally{t&&X(!1)}})(),r=d.observeRequestsForTeacher(a,async u=>{if(!t)return;const D=u.filter(h=>h.status==="pending").map(async h=>{const k=await d.getUser(h.studentId);return{...h,studentName:(k==null?void 0:k.name)||"Usuario"}}),R=await Promise.all(D);t&&b(R);const v=u.filter(h=>h.status==="approved"),S=new Map;v.forEach(h=>{S.has(h.studentId)||S.set(h.studentId,h)});const H=Array.from(S.values()).map(async h=>{const k=await d.getUser(h.studentId);return k?{...k,requestId:h.id}:null}),T=await Promise.all(H);t&&_(T.filter(h=>h!==null))}),f=d.observeBookingsForUser(a,"teacher",async u=>{if(!t)return;const D=u.filter(v=>v.status==="pending").map(async v=>{const S=await d.getUser(v.studentId);return{...v,studentName:(S==null?void 0:S.name)||"Usuario"}}),R=await Promise.all(D);if(t&&I(R),u.length>0){const v=new Date().toISOString().split("T")[0],H=[...u.filter(T=>T.status!=="cancelled"&&T.status!=="pending"&&T.date>=v)].sort((T,h)=>{const k=T.date.localeCompare(h.date);return k!==0?k:T.time.localeCompare(h.time)});W(H[0]??null)}else W(null)}),()=>{t=!1,r&&r(),f&&f()}},[a]);const be=async t=>{try{await d.updateRequestStatus(t,"approved"),x.success("Solicitud aceptada")}catch(r){console.error("Error accepting request:",r),x.error("Error al procesar solicitud")}},fe=async t=>{try{await d.updateBookingStatus(t,"confirmed"),x.success("Clase confirmada")}catch(r){console.error("Error accepting booking:",r),x.error("Error al confirmar clase")}},je=async t=>{try{await d.updateBookingStatus(t,"cancelled"),x.success("Clase rechazada")}catch(r){console.error("Error rejecting booking:",r),x.error("Error al rechazar clase")}},ve=async t=>{try{await d.updateRequestStatus(t,"rejected"),b(r=>r.filter(f=>f.id!==t)),x.success("Solicitud rechazada")}catch(r){console.error("Error rejecting request:",r),x.error("Error al rechazar solicitud")}},we=async t=>{await d.updateTeacherAvailability(a,t),n(t),x.success("Horario actualizado correctamente")},Ne=async t=>{try{const r={...t,id:`hw_${Date.now()}`,teacherId:a,status:"pending",assignedAt:Date.now()};await d.createHomework(r),A(f=>[r,...f]),x.success("Tarea asignada correctamente")}catch(r){console.error("Error create homework",r),x.error("Error al asignar tarea")}},ye=()=>{o(),p("/")},P=t=>t<10?{name:"Novato",next:"Instructor",target:10,currentComm:.5,nextComm:.55}:t<50?{name:"Instructor",next:"Profesor",target:50,currentComm:.55,nextComm:.6}:t<200?{name:"Profesor",next:"Maestro",target:200,currentComm:.6,nextComm:.7}:{name:"Maestro",next:"Gran Maestro",target:1e3,currentComm:.7,nextComm:.85},ee=P(m?m.classesGiven:0),ke=m?Math.min(100,m.classesGiven/ee.target*100):0,Ce=(m==null?void 0:m.currency)==="EUR"?"€":"$",Se=async t=>{t.preventDefault();const r=prompt("Nombre de tu nuevo club:");if(r){Q(!0);try{const f=await d.createClub(r,a);x.success("¡Club creado con éxito! Ahora eres Director de Club."),window.location.reload()}catch{x.error("Error al crear el club")}finally{Q(!1)}}},Te=async t=>{if(t.preventDefault(),!!B){Y(!0);try{const r=await d.inviteTeacherToClub(E.id,B);if(r.success){x.success(r.message),J("");const f=await d.getTeachers();Z(f.filter(te=>te.clubId===E.id))}else x.error(r.message)}catch{x.error("Error al invitar profesor")}finally{Y(!1)}}};i.useEffect(()=>{if(!E)return;(async()=>{const r=await d.getTeachers();Z(r.filter(f=>f.clubId===E.id))})()},[E]);const ze=async()=>{const t=await qe(),r=await Oe(t);sessionStorage.setItem("lichess_code_verifier",t);const f=new URLSearchParams({response_type:"code",client_id:ae.getLICHESS_CLIENT_ID(),redirect_uri:ae.getREDIRECT_URI(),scope:"study:read",code_challenge_method:"S256",code_challenge:r,state:Math.random().toString(36).substring(2)});window.location.href=`https://lichess.org/oauth?${f.toString()}`},Ae=async()=>{try{await d.updateTeacher(a,{lichessAccessToken:void 0,lichessUsername:void 0}),l(t=>t?{...t,lichessAccessToken:void 0,lichessUsername:void 0}:null),x.success("Desconectado de Lichess")}catch{x.error("Error al desconectar")}};return e.jsxs("div",{className:"p-4 md:p-8 max-w-7xl mx-auto space-y-6 md:space-y-8 animate-fade-in pb-24",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold font-display text-white",children:[c("dashboard.title")," ",e.jsx("span",{className:"text-gold",children:"."})]}),e.jsx("p",{className:"text-sm md:text-base text-text-muted",children:c("dashboard.subtitle")})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 md:gap-4 items-center w-full md:w-auto",children:[e.jsxs(M,{to:`/classroom/${a}`,className:"btn-secondary flex items-center gap-2 text-[10px] sm:text-sm md:text-base flex-1 md:flex-none justify-center py-2 px-2 sm:px-4",children:[e.jsx(Le,{size:18}),e.jsx("span",{className:"truncate",children:c("dashboard.my_classroom")})]}),e.jsxs("div",{className:"flex gap-1 p-1 bg-dark-panel rounded-lg border border-white/5 flex-1 md:flex-none justify-center",children:[e.jsx("button",{onClick:()=>s("overview"),className:`flex-1 md:flex-none px-2 sm:px-4 py-2 rounded-md text-[10px] sm:text-sm font-medium transition-all ${g==="overview"?"bg-gold text-black shadow-lg":"text-text-muted hover:text-white"}`,children:c("dashboard.overview")}),e.jsx("button",{onClick:()=>s("schedule"),className:`flex-1 md:flex-none px-2 sm:px-4 py-2 rounded-md text-[10px] sm:text-sm font-medium transition-all ${g==="schedule"?"bg-gold text-black shadow-lg":"text-text-muted hover:text-white"}`,children:c("dashboard.schedule")}),e.jsx("button",{onClick:()=>s("homework"),className:`flex-1 md:flex-none px-2 sm:px-4 py-2 rounded-md text-[10px] sm:text-sm font-medium transition-all ${g==="homework"?"bg-gold text-black shadow-lg":"text-text-muted hover:text-white"}`,children:"Tareas"}),e.jsx("button",{onClick:()=>s("club"),className:`flex-1 md:flex-none px-2 sm:px-4 py-2 rounded-md text-[10px] sm:text-sm font-medium transition-all ${g==="club"?"bg-gold text-black shadow-lg":"text-text-muted hover:text-white"}`,children:"Club"})]}),e.jsx("button",{onClick:ye,className:"p-2 text-text-muted hover:text-red-400 transition-colors rounded-lg border border-white/5 hover:border-red-500/20",title:c("nav.exit"),"aria-label":c("nav.exit"),children:e.jsx(ne,{size:20})})]})]}),g==="schedule"?e.jsx(We,{availability:U,handleSaveAvailability:we}):g==="homework"?e.jsx(Je,{homeworks:z,myStudents:y,isHomeworkModalOpen:ce,setIsHomeworkModalOpen:xe,handleCreateHomework:Ne}):g==="club"?e.jsx(Ve,{club:E,teacherProfile:m,clubTeachers:he,handleCreateClub:Se,isCreatingClub:pe,inviteEmail:B,setInviteEmail:J,handleInviteTeacher:Te,isInviting:ge}):e.jsx(Ye,{isLoading:me,stats:j,levelInfo:ee,currency:Ce,progressPercent:ke,teacherProfile:m,requests:w,pendingBookings:N,handleAcceptRequest:be,handleRejectRequest:ve,handleAcceptBooking:fe,handleRejectBooking:je,nextBooking:de,currentUserId:a,myStudents:y,handleLichessConnect:ze,handleLichessDisconnect:Ae})]})};export{mt as default};
