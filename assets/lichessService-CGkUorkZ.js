const c="topchess-app",i=window.location.origin+"/TopChess/lichess-callback",l={async getUserStudies(o,t){try{if(!o)return[];const r={};t&&(r.Authorization=`Bearer ${t}`);const e=`https://lichess.org/api/study/by/${o}`,n=await fetch(e,{headers:r});if(!n.ok)throw new Error("Error fetching studies");return(await n.text()).split(`
`).filter(s=>s.trim()).map(s=>{try{return JSON.parse(s)}catch{return null}}).filter(Boolean)}catch(r){return console.error("Lichess API Error:",r),[]}},async getStudyPgn(o,t){try{const r={};t&&(r.Authorization=`Bearer ${t}`);const e=await fetch(`https://lichess.org/api/study/${o}.pgn`,{headers:r});if(!e.ok)throw new Error("Error fetching PGN");return await e.text()}catch(r){return console.error("Lichess PGN Error:",r),""}},async exchangeCodeForToken(o,t){try{const r=new URLSearchParams({grant_type:"authorization_code",code:o,code_verifier:t,redirect_uri:i,client_id:c}),e=await fetch("https://lichess.org/api/token",{method:"POST",body:r});if(!e.ok){const a=await e.text();return console.error("Token exchange failed:",a),null}return(await e.json()).access_token}catch(r){return console.error("Lichess token error:",r),null}},async getAuthUser(o){try{const t=await fetch("https://lichess.org/api/account",{headers:{Authorization:`Bearer ${o}`}});return t.ok?await t.json():null}catch{return null}},parseChapters(o){return o.split(/\[Event /g).filter(Boolean).map(r=>{const e="[Event "+r.trim(),n=e.match(/\[Event "(.*)"\]/);return{name:n?n[1]:"Sin t√≠tulo",pgn:e}})},getLICHESS_CLIENT_ID(){return c},getREDIRECT_URI(){return i}};export{l};
