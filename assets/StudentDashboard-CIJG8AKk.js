import{c as $,a as A,u as R,r as a,j as e,L as m,f as o,z as b}from"./index-wncQym_1.js";import{m as h}from"./mockDatabase-Ca8sFJxX.js";import{T as F,S as n,V,X as q,C as H}from"./Skeleton-CO5lBEAm.js";import{L as J}from"./log-out-TWCfp_xv.js";import{C as O}from"./calendar-D6JDQyFE.js";import{C as U}from"./clock-JB3g5ABY.js";import"./check-CiVEnr4s.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=$("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),ee=()=>{const v=A(),{currentUserId:l,logout:N}=v,w=R(),[y,p]=a.useState(0),[g,k]=a.useState([]),[u,S]=a.useState([]),[C,j]=a.useState(!0),[d,x]=a.useState(null),[T,L]=a.useState([]);a.useEffect(()=>{const s=h.getWallet(l);p(s.balance),l&&(async()=>{j(!0);try{const r=await o.getRequestsForStudent(l),B=r.filter(t=>t.status==="approved").map(t=>o.getTeacherById(t.teacherId)),I=await Promise.all(B),D=r.filter(t=>t.status==="pending").map(async t=>{const f=await o.getTeacherById(t.teacherId);return f?{...f,requestDate:t.timestamp}:null}),M=await Promise.all(D);k(I.filter(t=>t!==null)),S(M.filter(t=>t!==null))}catch(r){console.error("Error fetching dashboard data",r),b.error("Error al cargar datos")}finally{j(!1)}})();const c=()=>{p(h.getWallet(l).balance)};return window.addEventListener("wallet-update",c),()=>window.removeEventListener("wallet-update",c)},[l]);const E=async s=>{const i=await o.getTeacherAvailability(s.id);L(i),x(s)},P=s=>{const c=`Próximo ${["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"][s.dayIndex]}`;b.promise(new Promise(r=>setTimeout(r,1e3)),{loading:"Confirmando reserva...",success:`Clase reservada para el ${c} a las ${s.hour}`,error:"Error al reservar"}).then(()=>{d&&(h.createBooking(l,d.id,`${s.dayIndex}-${s.hour}`,"2023-11-20"),x(null))})},z=()=>{N(),w("/")};return e.jsxs("div",{className:"p-8 max-w-7xl mx-auto space-y-8 animate-fade-in pb-24",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold font-display text-white",children:["Hola, ",e.jsx("span",{className:"text-gold",children:"Estudiante"})]}),e.jsx("p",{className:"text-text-muted",children:"Continúa tu camino hacia la maestría."})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"bg-dark-panel border border-white/10 rounded-xl p-3 flex items-center gap-4 shadow-lg",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wider",children:"Saldo Disponible"}),e.jsxs("p",{className:"text-xl font-bold text-white font-mono",children:[y.toFixed(2),"€"]})]}),e.jsx(m,{to:"/wallet",className:"btn-primary py-1.5 px-3 text-xs",children:"Recargar"})]}),e.jsx("button",{onClick:z,className:"ml-2 p-2 text-text-muted hover:text-red-400 transition-colors rounded-lg border border-transparent hover:border-red-500/20",title:"Cerrar Sesión",children:e.jsx(J,{size:20})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("section",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(F,{className:"text-gold",size:20})," Mis Mentores"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:C?e.jsx(e.Fragment,{children:[1,2].map(s=>e.jsxs("div",{className:"glass-panel p-4 rounded-xl flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{variant:"circular",width:48,height:48}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(n,{width:"60%",height:20}),e.jsx(n,{width:"40%",height:12})]})]}),e.jsxs("div",{className:"flex gap-2 mt-auto",children:[e.jsx(n,{className:"flex-1",height:32}),e.jsx(n,{className:"flex-1",height:32})]})]},s))}):e.jsxs(e.Fragment,{children:[g.length===0&&e.jsxs("div",{className:"col-span-2 p-8 rounded-2xl border border-dashed border-white/10 text-center text-text-muted",children:[e.jsx("p",{children:"Aún no tienes mentores activos."}),e.jsx(m,{to:"/",className:"text-gold hover:underline mt-2 inline-block",children:"Buscar Profesor"})]}),g.map(s=>e.jsxs("div",{className:"glass-panel p-4 rounded-xl flex flex-col gap-4 group hover:border-gold/30 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:s.image,alt:s.name,className:"w-12 h-12 rounded-full object-cover border-2 border-gold/20"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-white",children:s.name}),e.jsx("p",{className:"text-xs text-text-muted",children:"GM • 2850 ELO"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-auto",children:[e.jsxs(m,{to:`/classroom/${s.id}`,className:"flex-1 btn-secondary text-center text-xs py-2 flex items-center justify-center gap-2",children:[e.jsx(V,{size:14})," Entrar al Aula"]}),e.jsxs("button",{onClick:()=>E(s),className:"flex-1 bg-white/5 hover:bg-gold hover:text-black border border-white/10 text-white text-xs py-2 rounded-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(O,{size:14})," Agendar"]})]})]},s.id))]})})]}),e.jsxs("section",{className:"glass-panel p-6 rounded-2xl",children:[e.jsx("h2",{className:"text-lg font-bold text-white mb-4",children:"Tu Progreso Semanal"}),e.jsx("div",{className:"flex justify-between items-end h-32 gap-2",children:[40,65,30,85,50,90,60].map((s,i)=>e.jsx("div",{className:"flex-1 bg-white/5 rounded-t-lg relative group overflow-hidden",children:e.jsx("div",{style:{height:`${s}%`},className:"absolute bottom-0 w-full bg-gradient-to-t from-gold/20 to-gold/60 transition-all duration-500 group-hover:to-gold"})},i))}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-text-muted font-mono",children:[e.jsx("span",{children:"L"}),e.jsx("span",{children:"M"}),e.jsx("span",{children:"X"}),e.jsx("span",{children:"J"}),e.jsx("span",{children:"V"}),e.jsx("span",{children:"S"}),e.jsx("span",{children:"D"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass-panel p-6 rounded-2xl",children:[e.jsxs("h3",{className:"font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(U,{className:"text-blue-400",size:18})," Solicitudes Enviadas"]}),e.jsxs("div",{className:"space-y-3",children:[u.length===0&&e.jsx("p",{className:"text-xs text-text-muted italic",children:"No tienes solicitudes pendientes."}),u.map(s=>e.jsxs("div",{className:"p-3 bg-white/5 rounded-lg border border-white/5 flex items-center gap-3 opacity-70",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/10 flex items-center justify-center text-xs",children:s.name.substring(0,2)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-white font-medium",children:s.name}),e.jsx("p",{className:"text-[10px] text-yellow-500",children:"Pendiente de aprobación"})]})]},s.id))]})]}),e.jsxs("div",{className:"glass-panel p-6 rounded-2xl bg-gradient-to-br from-dark-panel to-green-900/10 border-green-500/10",children:[e.jsxs("h3",{className:"font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(W,{className:"text-green-400",size:18})," Próxima Clase"]}),e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-3xl font-bold text-white mb-1",children:"18:00"}),e.jsx("p",{className:"text-sm text-green-400 font-mono mb-4",children:"Hoy, 13 Nov"}),e.jsx("button",{className:"w-full btn-primary py-2 text-sm",children:"Unirse ahora"})]})]})]})]}),d&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-dark-panel border border-white/10 rounded-2xl w-full max-w-lg overflow-hidden shadow-2xl relative",children:[e.jsx("button",{onClick:()=>x(null),className:"absolute top-4 right-4 text-text-muted hover:text-white",children:e.jsx(q,{size:24})}),e.jsxs("div",{className:"p-6 border-b border-white/5",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Reservar Clase"}),e.jsxs("p",{className:"text-sm text-text-muted",children:["con ",e.jsx("span",{className:"text-gold",children:d.name})]})]}),e.jsx("div",{className:"p-6",children:e.jsx(H,{mode:"view",availability:T,onSlotClick:P})})]})})]})};export{ee as default};
