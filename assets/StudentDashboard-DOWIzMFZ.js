import{c as L,r as c,j as e,X as U,C as re,z as b,i as q,B as le,a as ie,u as oe,f as d,e as ne}from"./index-B6yJWa-n.js";import{V as de,a as ce,E as xe,C as me}from"./Calendar-BnGXQHMT.js";import{C as pe}from"./credit-card-CnVPeRRw.js";import{S as he,A as O,Z as ue}from"./zap-Dx52LKJc.js";import{T as V,S as ge}from"./Skeleton-Clpykjwn.js";import{D as be}from"./dollar-sign-BenTqzM9.js";import{C as fe}from"./clock-Hl5KSoLl.js";import{T as je}from"./trending-up-B_fzBQWr.js";import"./check-usebGXgy.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=L("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=L("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=L("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Ne=({isOpen:m,onClose:a,onSuccess:h,teacher:s})=>{const[l,w]=c.useState(!1),[N,I]=c.useState("stripe");if(!m||!s)return null;const g=s.region==="EU",A=g?59:39,E=g?"€":"$",_=g?"":" USD",P=async()=>{w(!0);try{await new Promise(y=>setTimeout(y,800)),await h(N),a()}catch(y){console.error("Payment error:",y),b.error("Error al procesar el pago. Intenta nuevamente.")}finally{w(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-dark-panel border border-white/10 rounded-2xl w-full max-w-md overflow-hidden shadow-2xl relative",children:[e.jsx("button",{onClick:a,className:"absolute top-4 right-4 text-text-muted hover:text-white transition-colors",children:e.jsx(U,{size:24})}),e.jsxs("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-gold/10 to-transparent",children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[e.jsx(pe,{className:"text-gold",size:24}),"Plan Mensual (4 Clases)"]}),e.jsxs("p",{className:"text-sm text-text-muted mt-1",children:["Suscripción para clases con ",e.jsx("span",{className:"text-white font-bold",children:s.name})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-black/30 border border-white/5 rounded-2xl p-6 text-center shadow-inner",children:[e.jsx("p",{className:"text-xs font-bold text-text-muted uppercase tracking-wider mb-2",children:"Total a Pagar"}),e.jsxs("div",{className:"text-4xl font-black text-white",children:[E,A,_]}),e.jsx("p",{className:"text-xs text-gold/80 mt-2 font-medium",children:"Equivale a 4 reservas en el calendario"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs font-bold text-text-muted uppercase tracking-wider block",children:"Método de Pago"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>I("stripe"),className:`p-3 rounded-xl border flex flex-col items-center gap-2 transition-all ${N==="stripe"?"bg-white/10 border-gold/50":"bg-white/5 border-white/10 opacity-60 hover:opacity-100"}`,children:[e.jsx("div",{className:"text-white font-bold",children:"Stripe"}),e.jsx("div",{className:"text-[10px] text-text-muted",children:"Tarjeta de Crédito"})]}),e.jsxs("button",{onClick:()=>I("mercadopago"),className:`p-3 rounded-xl border flex flex-col items-center gap-2 transition-all ${N==="mercadopago"?"bg-white/10 border-blue-500/50":"bg-white/5 border-white/10 opacity-60 hover:opacity-100"}`,children:[e.jsx("div",{className:"text-blue-400 font-bold",children:"MercadoPago"}),e.jsx("div",{className:"text-[10px] text-text-muted",children:"Latinoamérica"})]})]})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-orange-500/10 border border-orange-500/20 flex gap-3 items-start",children:[e.jsx(re,{className:"text-orange-500 shrink-0",size:18}),e.jsx("p",{className:"text-xs text-orange-200/80",children:"Estás en modo seguro. Los pagos son procesados por proveedores certificados."})]}),e.jsx("button",{onClick:P,disabled:l,className:"w-full bg-gold hover:bg-gold/80 hover:brightness-110 text-black font-black uppercase tracking-widest py-4 rounded-xl transition-all hover:scale-[1.02] active:scale-[0.98] shadow-[0_0_20px_rgba(212,175,55,0.2)] mt-2 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:l?e.jsx("div",{className:"w-5 h-5 border-2 border-black/30 border-t-black rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(he,{size:18}),"Activar Suscripción"]})})]})]})})},ye=()=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"glass-panel p-6 rounded-3xl bg-gradient-to-br from-[#1a1917] to-gold/5 border-gold/20 relative overflow-hidden group hover:-translate-y-1 transition-transform duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gold/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 group-hover:bg-gold/20 transition-all duration-500"}),e.jsxs("div",{className:"flex items-center gap-4 mb-5 relative z-10",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:"w-14 h-14 transform -rotate-90",children:[e.jsx("circle",{cx:"28",cy:"28",r:"26",stroke:"currentColor",strokeWidth:"4",fill:"transparent",className:"text-white/5"}),e.jsx("circle",{cx:"28",cy:"28",r:"26",stroke:"currentColor",strokeWidth:"4",fill:"transparent",strokeDasharray:"163",strokeDashoffset:"40",className:"text-gold DropShadow transition-all duration-1000"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gold font-black",children:"L5"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-black text-gold uppercase tracking-widest mb-1",children:"Rango Actual"}),e.jsx("p",{className:"text-lg font-bold text-white leading-none",children:"Aprendiz Bronce"})]})]}),e.jsxs("div",{className:"space-y-2 relative z-10",children:[e.jsxs("div",{className:"flex justify-between text-[10px] font-bold uppercase tracking-wider",children:[e.jsx("span",{className:"text-text-muted",children:"Progreso Nivel 6"}),e.jsx("span",{className:"text-gold",children:"750/1000 XP"})]}),e.jsx("div",{className:"h-1.5 w-full bg-black/40 rounded-full overflow-hidden border border-white/5",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-gold to-yellow-300 rounded-full w-[75%] shadow-[0_0_10px_rgba(255,215,0,0.5)]"})})]})]}),e.jsxs("div",{className:"glass-panel p-6 rounded-3xl border-white/5 relative overflow-hidden group hover:-translate-y-1 transition-transform duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 group-hover:bg-blue-500/20 transition-all duration-500"}),e.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[e.jsx("div",{className:"p-3 rounded-2xl bg-blue-500/10 text-blue-400 border border-blue-500/20 shadow-[0_0_15px_rgba(59,130,246,0.2)]",children:e.jsx(W,{size:24})}),e.jsx("span",{className:"px-2 py-1 bg-white/5 rounded-md text-[9px] font-black text-blue-400 uppercase tracking-widest",children:"Misión Diaria"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("p",{className:"text-sm font-bold text-white mb-3",children:"Resuelve 5 Tácticas"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 h-2 bg-black/40 rounded-full overflow-hidden border border-white/5",children:e.jsx("div",{className:"h-full bg-blue-400 w-[60%] shadow-[0_0_10px_rgba(59,130,246,0.5)]"})}),e.jsx("span",{className:"text-[11px] text-white font-black bg-white/10 px-2 py-0.5 rounded",children:"3/5"})]}),e.jsx("p",{className:"text-[10px] text-blue-400/70 mt-3 font-bold",children:"+50 XP al completar"})]})]}),e.jsxs("div",{className:"glass-panel p-6 rounded-3xl bg-gradient-to-br from-[#1a1917] to-orange-500/5 border-orange-500/20 relative overflow-hidden group hover:-translate-y-1 transition-transform duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-orange-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 group-hover:bg-orange-500/20 transition-all duration-500"}),e.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[e.jsx("div",{className:"p-3 rounded-2xl bg-orange-500/10 text-orange-500 border border-orange-500/20 shadow-[0_0_15px_rgba(249,115,22,0.2)] animate-pulse",children:e.jsx(ve,{size:24})}),e.jsx("span",{className:"px-2 py-1 bg-white/5 rounded-md text-[9px] font-black text-orange-500 uppercase tracking-widest",children:"Racha Activa"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[e.jsx("span",{className:"text-4xl font-black text-white drop-shadow-md",children:"7"}),e.jsx("span",{className:"text-sm font-bold text-orange-500",children:"Días"})]}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5,6,7].map((m,a)=>e.jsx("div",{className:`h-1.5 flex-1 rounded-full ${a<7?"bg-orange-500 shadow-[0_0_5px_rgba(249,115,22,0.8)]":"bg-white/10"}`},a))}),e.jsx("p",{className:"text-[10px] text-text-muted mt-3 font-medium",children:"¡Estás on fire! 1 día más para bono."})]})]}),e.jsxs("div",{className:"glass-panel p-6 rounded-3xl border-white/5 relative overflow-hidden group hover:-translate-y-1 transition-transform duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 group-hover:bg-purple-500/20 transition-all duration-500"}),e.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[e.jsx("div",{className:"p-3 rounded-2xl bg-purple-500/10 text-purple-400 border border-purple-500/20 shadow-[0_0_15px_rgba(168,85,247,0.2)]",children:e.jsx(O,{size:24})}),e.jsx("span",{className:"px-2 py-1 bg-white/5 rounded-md text-[9px] font-black text-purple-400 uppercase tracking-widest",children:"Logros Reclutados"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex gap-3 mb-2",children:[e.jsx("div",{title:"Primera Victoria",className:"w-10 h-10 rounded-full bg-gradient-to-br from-yellow-300 to-yellow-600 flex items-center justify-center shadow-lg border-2 border-yellow-200/50 transform hover:scale-110 transition-transform",children:e.jsx(we,{size:18,className:"text-white fill-white"})}),e.jsx("div",{title:"Táctico Rápido",className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-blue-700 flex items-center justify-center shadow-lg border-2 border-blue-300/50 transform hover:scale-110 transition-transform",children:e.jsx(ue,{size:18,className:"text-white fill-white"})}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/5 border border-white/10 border-dashed flex items-center justify-center text-white/20",children:e.jsx(O,{size:18})})]}),e.jsx("p",{className:"text-[10px] text-text-muted mt-3 font-medium cursor-pointer hover:text-white transition-colors",children:"Ver vitrina de trofeos →"})]})]})]}),ke=({isLoading:m,myTeachers:a,openBookingModal:h,handleOpenPaymentModal:s})=>e.jsxs("section",{children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gold/10",children:e.jsx(V,{className:"text-gold",size:20})}),"Mis Mentores"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:m?[1,2].map(l=>e.jsx(ge,{width:"100%",height:150},l)):e.jsx(e.Fragment,{children:a.length===0?e.jsxs("div",{className:"col-span-1 md:col-span-2 p-12 rounded-3xl border-2 border-dashed border-white/5 bg-white/[0.01] text-center",children:[e.jsx("p",{className:"text-text-muted mb-4 text-sm italic",children:"No tienes mentores activos todavía."}),e.jsx(q,{to:"/",className:"btn-secondary py-3 px-8 text-xs",children:"Explorar catálogo"})]}):a.map(l=>e.jsxs("div",{className:"glass-panel p-6 rounded-2xl bg-[#1b1a17] border border-white/5 group hover:border-gold/30 transition-all duration-500",children:[e.jsxs("div",{className:"flex items-center gap-5 mb-6",children:[e.jsx("img",{src:l.image||`https://ui-avatars.com/api/?name=${encodeURIComponent(l.name)}&background=random`,alt:l.name,className:"w-16 h-16 rounded-2xl object-cover border border-white/10",onError:w=>{w.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(l.name)}&background=random`}}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-bold text-white text-lg truncate group-hover:text-gold transition-colors",children:l.name}),e.jsxs("p",{className:"text-[10px] text-text-muted font-black uppercase tracking-widest mt-0.5",children:[l.elo," ELO • Mentor"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[e.jsxs("div",{className:"col-span-2 flex justify-between items-center bg-black/40 px-4 py-2 rounded-lg border border-white/5 mb-2",children:[e.jsx("span",{className:"text-xs text-text-muted font-bold",children:"Clases Disponibles:"}),e.jsx("span",{className:"text-lg font-black text-gold",children:l.classCredits||0})]}),l.classCredits>0?e.jsxs(e.Fragment,{children:[e.jsxs(q,{to:`/classroom/${l.id}`,className:"flex items-center justify-center gap-2 bg-white/5 hover:bg-white/10 text-white text-[10px] font-black uppercase tracking-widest py-3 rounded-xl transition-all border border-white/5",children:[e.jsx(de,{size:14,className:"text-gold"})," Aula"]}),e.jsxs("button",{onClick:()=>h(l),className:"flex items-center justify-center gap-2 bg-gold hover:bg-white text-black text-[10px] font-black uppercase tracking-widest py-3 rounded-xl transition-all shadow-lg shadow-gold/5",children:[e.jsx(ce,{size:14})," Agendar"]})]}):e.jsxs("button",{onClick:()=>s(l),className:"col-span-2 flex items-center justify-center gap-2 bg-gold hover:bg-white text-black text-[10px] font-black uppercase tracking-widest py-3 rounded-xl transition-all shadow-lg shadow-gold/5",children:[e.jsx(be,{size:14})," Pagar Mensualidad"]})]})]},l.id))})})]}),Se=({nextClass:m,myHomeworks:a,pendingRequests:h})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass-panel p-6 rounded-3xl bg-gradient-to-br from-[#1b1a17] to-green-900/10 border-green-500/20 relative overflow-hidden",children:[e.jsxs("h3",{className:"font-bold text-white mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-500/10",children:e.jsx(W,{className:"text-green-400",size:18})}),"Próxima Clase"]}),m?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-4xl font-bold text-white mb-1 tracking-tighter",children:m.time}),e.jsx("p",{className:"text-xs text-green-400 font-mono mb-8 uppercase tracking-widest",children:m.date}),e.jsx(q,{to:m.meetingLink,className:"w-full bg-green-500 hover:bg-green-400 text-black py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition-all block text-center",children:"Entrar al Aula"})]}):e.jsx("div",{className:"text-center py-10 opacity-20 italic text-sm",children:"No hay clases próximas"})]}),e.jsxs("div",{className:"glass-panel p-6 rounded-3xl border-white/5 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-blue-500/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 group-hover:bg-blue-500/20 transition-all"}),e.jsxs("h3",{className:"font-bold text-white mb-6 flex items-center gap-3 relative z-10",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(le,{className:"text-blue-400",size:18})}),"Mis Tareas"]}),e.jsx("div",{className:"space-y-3 relative z-10",children:a.length===0?e.jsx("p",{className:"text-xs text-text-muted italic opacity-50 text-center py-4",children:"No tienes tareas asignadas"}):a.map(s=>e.jsxs("a",{href:s.type==="lichess_study"?s.referenceData:"#",target:"_blank",rel:"noopener noreferrer",className:"block p-4 bg-white/[0.02] hover:bg-white/[0.05] rounded-2xl border border-white/5 hover:border-blue-400/30 transition-all group/item",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:`text-[10px] font-black uppercase tracking-widest px-2 py-0.5 rounded ${s.status==="completed"?"bg-green-500/10 text-green-400":"bg-yellow-500/10 text-yellow-500"}`,children:s.status==="completed"?"Completado":"Pendiente"}),s.type==="lichess_study"&&e.jsx(xe,{size:12,className:"text-text-muted group-hover/item:text-white"})]}),e.jsx("h4",{className:"font-bold text-white text-sm mb-1 truncate",children:s.title}),e.jsx("p",{className:"text-xs text-text-muted line-clamp-1",children:s.description||"Sin descripción"})]},s.id))})]}),e.jsxs("div",{className:"glass-panel p-6 rounded-3xl border-white/5",children:[e.jsxs("h3",{className:"font-bold text-white mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(fe,{className:"text-blue-400",size:18})}),"Solicitudes"]}),e.jsx("div",{className:"space-y-4",children:h.length===0?e.jsx("p",{className:"text-xs text-text-muted italic opacity-50 text-center py-4",children:"Sin solicitudes pendientes"}):h.map(s=>e.jsxs("div",{className:"p-4 bg-white/[0.02] rounded-2xl border border-white/5 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-xs font-bold text-white/20 border border-white/10 uppercase",children:s.name.substring(0,2)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white font-bold truncate",children:s.name}),e.jsx("p",{className:"text-[10px] text-blue-400/80 font-black uppercase tracking-widest",children:"Enviada"})]})]},s.id))})]})]}),Be=()=>{var F;const m=ie(),{currentUserId:a,logout:h,currentUser:s}=m,l=oe(),[w,N]=c.useState(0),[I,g]=c.useState([]),[A,E]=c.useState([]),[_,P]=c.useState([]),[y,H]=c.useState([]),[X,$]=c.useState(!0),[Z,B]=c.useState(!1),[u,k]=c.useState(null),[J,G]=c.useState([]),[K,D]=c.useState(!1);c.useEffect(()=>{if(!a)return;let t=!0,o,p,f;return(async()=>{$(!0);try{const i=await d.getHomeworksForStudent(a);t&&H(i)}catch(i){console.error("Error loading static student data",i)}finally{t&&$(!1)}})(),f=d.observeWallet(a,i=>{t&&N(i.balance)}),o=d.observeRequestsForStudent(a,async i=>{if(!t)return;const S=i.filter(r=>r.status==="approved"),n=new Map;S.forEach(r=>{n.has(r.teacherId)||n.set(r.teacherId,r)});const v=Array.from(n.values()).map(async r=>{const M=await d.getTeacherById(r.teacherId);return M?{...M,classCredits:r.classCredits||0}:null}),C=await Promise.all(v);t&&g(C.filter(r=>r!==null));const R=i.filter(r=>r.status==="pending"),z=new Map;R.forEach(r=>{z.has(r.teacherId)||z.set(r.teacherId,r)});const x=Array.from(z.values()).map(async r=>{const M=await d.getTeacherById(r.teacherId);return M?{...M,requestDate:r.timestamp}:null}),T=await Promise.all(x);t&&E(T.filter(r=>r!==null))}),p=d.observeBookingsForUser(a,"student",i=>{t&&P(i)}),()=>{t=!1,o&&o(),p&&p(),f&&f()}},[a]);const Q=async t=>{const o=await d.getTeacherAvailability(t.id);G(o),k(t),D(!0)},Y=t=>{k(t),B(!0)},ee=async t=>{if(u)try{const o=await d.buySubscription(a,u,t);if(o.success){b.success(o.message),B(!1),k(null);const f=(await d.getRequestsForStudent(a)).filter(n=>n.status==="approved"),j=new Map;f.forEach(n=>{j.has(n.teacherId)||j.set(n.teacherId,n)});const i=Array.from(j.values()).map(async n=>{const v=await d.getTeacherById(n.teacherId);return v?{...v,classCredits:n.classCredits||0}:null}),S=await Promise.all(i);g(S.filter(n=>n!==null))}else b.error(o.message)}catch(o){console.error("Error processing subscription:",o),b.error("Error al procesar la suscripción")}},se=async t=>{`${["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"][t.dayIndex]}`;const p=`${t.dayIndex}-${t.hour}`,j={id:`booking_${Date.now()}`,studentId:a,teacherId:u.id,slotId:p,date:new Date().toISOString().split("T")[0],time:t.hour,status:"confirmed",timestamp:Date.now(),meetingLink:`/classroom/${u.id}`};try{const i=await d.bookClass(a,u.id,j);if(i.success){b.success(i.message),k(null),D(!1);const S=await d.getBookingsForUser(a,"student");P(S);const v=(await d.getRequestsForStudent(a)).filter(x=>x.status==="approved"),C=new Map;v.forEach(x=>{C.has(x.teacherId)||C.set(x.teacherId,x)});const R=Array.from(C.values()).map(async x=>{const T=await d.getTeacherById(x.teacherId);return T?{...T,classCredits:x.classCredits||0}:null}),z=await Promise.all(R);g(z.filter(x=>x!==null))}else b.error(i.message)}catch(i){console.error("Error creating booking",i),b.error("Error al reservar la clase")}},te=()=>{h(),l("/")},ae=[..._].filter(t=>t.status!=="cancelled").sort((t,o)=>{const p=t.date.localeCompare(o.date);return p!==0?p:t.time.localeCompare(o.time)})[0]??null;return e.jsxs("div",{className:"p-4 md:p-8 max-w-7xl mx-auto space-y-6 md:space-y-8 animate-fade-in pb-24",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-gold to-orange-500 rounded-full blur opacity-25 group-hover:opacity-50 transition duration-1000 group-hover:duration-200"}),e.jsx("div",{className:"relative w-16 h-16 rounded-full bg-dark-panel border-2 border-gold/30 flex items-center justify-center font-bold text-2xl text-gold shadow-2xl",children:((F=s==null?void 0:s.displayName)==null?void 0:F.charAt(0))||"A"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 border-4 border-dark-panel rounded-full"})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold font-display text-white",children:["Hola, ",e.jsx("span",{className:"text-gold",children:(s==null?void 0:s.displayName)||"Alumno"})," ",e.jsx("span",{className:"text-white/20",children:"."})]}),e.jsxs("p",{className:"text-sm md:text-base text-text-muted flex items-center gap-2",children:[e.jsx(je,{size:14,className:"text-green-400"}),"Tu progreso en TopChess está despegando."]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[e.jsxs("div",{className:"flex-1 md:flex-none glass-panel px-4 py-2 rounded-xl flex items-center gap-3 border-gold/10",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gold/10 text-gold",children:e.jsx(V,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-widest",children:"Activo"}),e.jsx("p",{className:"text-sm font-bold text-white",children:"TopChess"})]})]}),e.jsx("button",{onClick:te,"aria-label":"Cerrar Sesión",className:"p-3 text-text-muted hover:text-red-400 transition-all rounded-xl border border-white/5 hover:border-red-500/20 bg-white/2",title:"Cerrar Sesión",children:e.jsx(ne,{size:20})})]})]}),e.jsx(ye,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-8",children:e.jsx(ke,{isLoading:X,myTeachers:I,openBookingModal:Q,handleOpenPaymentModal:Y})}),e.jsx(Se,{nextClass:ae,myHomeworks:y,pendingRequests:A})]}),u&&K&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-dark-panel border border-white/10 rounded-2xl w-full max-w-lg overflow-hidden shadow-2xl relative",children:[e.jsx("button",{onClick:()=>{k(null),D(!1)},className:"absolute top-4 right-4 text-text-muted hover:text-white","aria-label":"Cerrar Modal",children:e.jsx(U,{size:24})}),e.jsxs("div",{className:"p-6 border-b border-white/5",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Reservar Clase"}),e.jsxs("p",{className:"text-sm text-text-muted",children:["con ",e.jsx("span",{className:"text-gold",children:u.name})]})]}),e.jsx("div",{className:"p-6",children:e.jsx(me,{mode:"view",availability:J,onSlotClick:se})})]})}),e.jsx(Ne,{isOpen:Z,onClose:()=>B(!1),onSuccess:ee,teacher:u})]})};export{Be as default};
