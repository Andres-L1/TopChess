import{c as V,a as X,u as G,r as l,j as e,e as H,h as g,f as r,z as u}from"./index-BlMM7rvT.js";import{V as y,S as J,X as W,C as K}from"./Skeleton-BNb_YsJj.js";import{T as Q}from"./trending-up-DEklAUSA.js";import{D as Y}from"./dollar-sign-BA0s_s9k.js";import{T as k}from"./trophy-CSfoYHZ7.js";import{C as Z}from"./calendar-BoVyDxVj.js";import{C as ee}from"./clock-7zch4R9F.js";import"./check-0BgLtmWv.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=V("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),oe=()=>{const C=X(),{currentUserId:i,logout:T}=C,I=G(),[z,A]=l.useState(0),[b,B]=l.useState([]),[f,E]=l.useState([]),[M,j]=l.useState([]),[P,v]=l.useState(!0),[c,m]=l.useState(null),[D,L]=l.useState([]);l.useEffect(()=>{i&&(async()=>{v(!0);try{const[a,d,h]=await Promise.all([r.getRequestsForStudent(i),r.getBookingsForUser(i,"student"),r.getWallet(i)]);A(h.balance);const N=a.filter(t=>t.status==="approved"),n=new Map;N.forEach(t=>{n.has(t.teacherId)||n.set(t.teacherId,t)});const o=Array.from(n.values()).map(t=>r.getTeacherById(t.teacherId)),F=await Promise.all(o),U=a.filter(t=>t.status==="pending"),p=new Map;U.forEach(t=>{p.has(t.teacherId)||p.set(t.teacherId,t)});const _=Array.from(p.values()).map(async t=>{const w=await r.getTeacherById(t.teacherId);return w?{...w,requestDate:t.timestamp}:null}),O=await Promise.all(_);B(F.filter(t=>t!==null)),E(O.filter(t=>t!==null)),j(d)}catch(a){console.error("Error fetching dashboard data",a),u.error("Error al cargar datos")}finally{v(!1)}})()},[i]);const $=async s=>{const a=await r.getTeacherAvailability(s.id);L(a),m(s)},R=async s=>{const d=`Próximo ${["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"][s.dayIndex]}`,h=`${s.dayIndex}-${s.hour}`,n={id:`booking_${Date.now()}`,studentId:i,teacherId:c.id,slotId:h,date:new Date().toISOString().split("T")[0],time:s.hour,status:"confirmed",timestamp:Date.now(),meetingLink:`/classroom/${c.id}`};try{await r.createBooking(n),u.success(`Clase reservada para el ${d} a las ${s.hour}`),m(null);const o=await r.getBookingsForUser(i,"student");j(o)}catch(o){console.error("Error creating booking",o),u.error("Error al reservar la clase")}},q=()=>{T(),I("/")},x=[...M].filter(s=>s.status!=="cancelled").sort((s,a)=>{const d=s.date.localeCompare(a.date);return d!==0?d:s.time.localeCompare(a.time)})[0]??null;return e.jsxs("div",{className:"p-4 md:p-8 max-w-7xl mx-auto space-y-6 md:space-y-8 animate-fade-in pb-24",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-gold to-orange-500 rounded-full blur opacity-25 group-hover:opacity-50 transition duration-1000 group-hover:duration-200"}),e.jsx("div",{className:"relative w-16 h-16 rounded-full bg-dark-panel border-2 border-gold/30 flex items-center justify-center font-bold text-2xl text-gold shadow-2xl",children:"A"}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 border-4 border-dark-panel rounded-full"})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold font-display text-white",children:["Hola, ",e.jsx("span",{className:"text-gold",children:"Alumno"})," ",e.jsx("span",{className:"text-white/20",children:"."})]}),e.jsxs("p",{className:"text-sm md:text-base text-text-muted flex items-center gap-2",children:[e.jsx(Q,{size:14,className:"text-green-400"}),"Tu progreso en TopChess está despegando."]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[e.jsxs("div",{className:"flex-1 md:flex-none glass-panel px-4 py-2 rounded-xl flex items-center gap-3 border-gold/10",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gold/10 text-gold",children:e.jsx(Y,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-text-muted uppercase font-black tracking-widest",children:"Balance"}),e.jsxs("p",{className:"text-sm font-bold text-white",children:[z.toFixed(2),"€"]})]})]}),e.jsx("button",{onClick:q,className:"p-3 text-text-muted hover:text-red-400 transition-all rounded-xl border border-white/5 hover:border-red-500/20 bg-white/2",title:"Cerrar Sesión",children:e.jsx(H,{size:20})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"glass-panel p-5 rounded-2xl bg-gradient-to-br from-dark-panel to-gold/5 border-gold/10 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-gold/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 group-hover:bg-gold/20 transition-all"}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gold text-black shadow-lg shadow-gold/20",children:e.jsx(k,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-black text-gold uppercase tracking-widest",children:"Nivel Actual"}),e.jsx("p",{className:"text-xl font-bold text-white",children:"Aprendiz Bronce"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-[10px] font-bold uppercase tracking-wider",children:[e.jsx("span",{className:"text-text-muted",children:"Progreso al Nivel 5"}),e.jsx("span",{className:"text-gold",children:"750 / 1000 XP"})]}),e.jsx("div",{className:"h-2 w-full bg-black/40 rounded-full overflow-hidden border border-white/5",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-gold to-orange-500 rounded-full w-[75%] shadow-[0_0_10px_rgba(255,215,0,0.3)]"})})]})]}),e.jsxs("div",{className:"glass-panel p-5 rounded-2xl border-white/5 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-blue-500/10 text-blue-400",children:e.jsx(S,{size:20})}),e.jsx("span",{className:"text-[10px] font-black text-blue-400 uppercase tracking-widest",children:"Misión Diaria"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white mb-1",children:"Gana 2 partidas tácticas"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1 bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-400 w-1/2"})}),e.jsx("span",{className:"text-[10px] text-text-muted font-mono",children:"1/2"})]})]})]}),e.jsxs("div",{className:"glass-panel p-5 rounded-2xl border-white/5 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:"p-3 rounded-xl bg-purple-500/10 text-purple-400",children:e.jsx(y,{size:20})}),e.jsx("span",{className:"text-[10px] font-black text-purple-400 uppercase tracking-widest",children:"Aprendizaje"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white mb-2",children:"Total Clases Recibidas"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-white",children:"12"}),e.jsx("span",{className:"text-xs text-text-muted",children:"horas de estudio"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8",children:[e.jsx("div",{className:"lg:col-span-2 space-y-8",children:e.jsxs("section",{children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gold/10",children:e.jsx(k,{className:"text-gold",size:20})}),"Mis Mentores"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:P?[1,2].map(s=>e.jsx(J,{width:"100%",height:150},s)):e.jsx(e.Fragment,{children:b.length===0?e.jsxs("div",{className:"col-span-1 md:col-span-2 p-12 rounded-3xl border-2 border-dashed border-white/5 bg-white/[0.01] text-center",children:[e.jsx("p",{className:"text-text-muted mb-4 text-sm italic",children:"No tienes mentores activos todavía."}),e.jsx(g,{to:"/",className:"btn-secondary py-3 px-8 text-xs",children:"Explorar catálogo"})]}):b.map(s=>e.jsxs("div",{className:"glass-panel p-6 rounded-2xl bg-[#1b1a17] border border-white/5 group hover:border-gold/30 transition-all duration-500",children:[e.jsxs("div",{className:"flex items-center gap-5 mb-6",children:[e.jsx("img",{src:s.image||"https://ui-avatars.com/api/?name=Profesor+Chess&background=random",alt:s.name,className:"w-16 h-16 rounded-2xl object-cover border border-white/10"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-bold text-white text-lg truncate group-hover:text-gold transition-colors",children:s.name}),e.jsxs("p",{className:"text-[10px] text-text-muted font-black uppercase tracking-widest mt-0.5",children:[s.elo," ELO • Mentor"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(g,{to:`/classroom/${s.id}`,className:"flex items-center justify-center gap-2 bg-white/5 hover:bg-white/10 text-white text-[10px] font-black uppercase tracking-widest py-3 rounded-xl transition-all border border-white/5",children:[e.jsx(y,{size:14,className:"text-gold"})," Aula"]}),e.jsxs("button",{onClick:()=>$(s),className:"flex items-center justify-center gap-2 bg-gold hover:bg-white text-black text-[10px] font-black uppercase tracking-widest py-3 rounded-xl transition-all shadow-lg shadow-gold/5",children:[e.jsx(Z,{size:14})," Agendar"]})]})]},s.id))})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass-panel p-6 rounded-3xl bg-gradient-to-br from-[#1b1a17] to-green-900/10 border-green-500/20 relative overflow-hidden",children:[e.jsxs("h3",{className:"font-bold text-white mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-500/10",children:e.jsx(S,{className:"text-green-400",size:18})}),"Próxima Clase"]}),x?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-4xl font-bold text-white mb-1 tracking-tighter",children:x.time}),e.jsx("p",{className:"text-xs text-green-400 font-mono mb-8 uppercase tracking-widest",children:x.date}),e.jsx(g,{to:x.meetingLink,className:"w-full bg-green-500 hover:bg-green-400 text-black py-4 rounded-2xl font-black text-xs uppercase tracking-widest transition-all block text-center",children:"Entrar al Aula"})]}):e.jsx("div",{className:"text-center py-10 opacity-20 italic text-sm",children:"No hay clases próximas"})]}),e.jsxs("div",{className:"glass-panel p-6 rounded-3xl border-white/5",children:[e.jsxs("h3",{className:"font-bold text-white mb-6 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(ee,{className:"text-blue-400",size:18})}),"Solicitudes"]}),e.jsx("div",{className:"space-y-4",children:f.length===0?e.jsx("p",{className:"text-xs text-text-muted italic opacity-50 text-center py-4",children:"Sin solicitudes pendientes"}):f.map(s=>e.jsxs("div",{className:"p-4 bg-white/[0.02] rounded-2xl border border-white/5 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-xs font-bold text-white/20 border border-white/10 uppercase",children:s.name.substring(0,2)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white font-bold truncate",children:s.name}),e.jsx("p",{className:"text-[10px] text-blue-400/80 font-black uppercase tracking-widest",children:"Enviada"})]})]},s.id))})]})]})]}),c&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-dark-panel border border-white/10 rounded-2xl w-full max-w-lg overflow-hidden shadow-2xl relative",children:[e.jsx("button",{onClick:()=>m(null),className:"absolute top-4 right-4 text-text-muted hover:text-white",children:e.jsx(W,{size:24})}),e.jsxs("div",{className:"p-6 border-b border-white/5",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Reservar Clase"}),e.jsxs("p",{className:"text-sm text-text-muted",children:["con ",e.jsx("span",{className:"text-gold",children:c.name})]})]}),e.jsx("div",{className:"p-6",children:e.jsx(K,{mode:"view",availability:D,onSlotClick:R})})]})})]})};export{oe as default};
